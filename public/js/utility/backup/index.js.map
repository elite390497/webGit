{"version":3,"file":"js/utility/backup/index.js?id=fa3806130e9cd08c32e6","sources":["webpack:///resources/js/views/utility/backup/index.vue","webpack:///./resources/js/views/utility/backup/index.vue","webpack:///./resources/js/views/utility/backup/index.vue?cf1d","webpack:///./resources/js/views/utility/backup/index.vue?dc49","webpack:///./resources/js/views/utility/backup/index.vue?b640"],"sourcesContent":["<template>\n    <div>\n        <div class=\"page-titles\">\n            <div class=\"row\">\n                <div class=\"col-12 col-sm-6\">\n                    <h3 class=\"text-themecolor\">{{trans('utility.backup')}}\n                        <span class=\"card-subtitle d-none d-sm-inline\" v-if=\"backups.total\">{{trans('general.total_result_found',{count : backups.total, from: backups.from, to: backups.to})}}</span>\n                        <span class=\"card-subtitle d-none d-sm-inline\" v-else>{{trans('general.no_result_found')}}</span>\n                    </h3>\n                </div>\n                <div class=\"col-12 col-sm-6\">\n                    <div class=\"action-buttons pull-right\">\n                        <sort-by :order-by-options=\"orderByOptions\" :sort-by=\"filter.sort_by\" :order=\"filter.order\" @updateSortBy=\"value => {filter.sort_by = value}\"  @updateOrder=\"value => {filter.order = value}\"></sort-by>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"container-fluid\">\n            <div class=\"card border-bottom\">\n                <div class=\"card-body p-4\">\n                    <h4 class=\"card-title\">{{trans('utility.generate_backup')}}</h4>\n                    <show-tip module=\"utility\" tip=\"tip_backup\"></show-tip>\n                    <div class=\"form-group\">\n                        <switches class=\"m-l-20\" v-model=\"backupForm.delete_previous\" theme=\"bootstrap\" color=\"success\"></switches> {{trans('utility.delete_previous_backup?')}}\n                    </div>\n                    <div class=\"form-group\">\n                        <button class=\"btn btn-info btn-sm\" @click.prevent=\"createBackup\">{{trans('utility.generate_backup')}}</button>\n                    </div>\n                </div>\n            </div>\n            <div class=\"card\">\n                <div class=\"card-body\">\n                    <div class=\"table-responsive\" v-if=\"backups.total\">\n                        <table class=\"table table-sm\">\n                            <thead>\n                                <tr>\n                                    <th>{{trans('utility.backup_name')}}</th>\n                                    <th>{{trans('utility.backup_generated_at')}}</th>\n                                    <th class=\"table-option\">{{trans('general.action')}}</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <tr v-for=\"backup in backups.data\">\n                                    <td v-text=\"backup.file\"></td>\n                                    <td>{{backup.created_at | momentDateTime }}</td>\n                                    <td class=\"table-option\">\n                                        <div class=\"btn-group\">\n                                            <a :href=\"getDownloadLink(backup)\" class=\"btn btn-success btn-sm\" v-tooltip=\"trans('utility.download_backup')\"><i class=\"fas fa-download\"></i></a>\n                                            <button class=\"btn btn-danger btn-sm\" :key=\"backup.id\" v-confirm=\"{ok: confirmDelete(backup)}\" v-tooltip=\"trans('utility.delete_backup')\"><i class=\"fas fa-trash\"></i></button>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </div>\n                    <module-info v-if=\"!backups.total\" module=\"utility\" title=\"backup_module_title\" description=\"backup_module_description\" icon=\"list\">\n                    </module-info>\n                    <pagination-record :page-length.sync=\"filter.page_length\" :records=\"backups\" @updateRecords=\"getBackups\" @change.native=\"getBackups\"></pagination-record>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n\n<script>\n    export default {\n        components : {  },\n        data() {\n            return {\n                backupForm: new Form({\n                    delete_previous: false\n                }),\n                backups: {\n                    total: 0,\n                    data: []\n                },\n                filter: {\n                    page_length: helper.getConfig('page_length'),\n                    sort_by: 'created_at',\n                    order: 'desc'\n                },\n                orderByOptions: [\n                    {\n                        value: 'created_at',\n                        translation: i18n.general.created_at\n                    }\n                ]\n            };\n        },\n        mounted(){\n            if(!helper.hasPermission('access-configuration')){\n                helper.notAccessibleMsg();\n                this.$router.push('/dashboard');\n            }\n\n            if(!helper.featureAvailable('backup')){\n                helper.featureNotAvailableMsg();\n                this.$router.push('/dashboard');\n            }\n\n            this.getBackups();\n        },\n        methods: {\n            createBackup(){\n                let loader = this.$loading.show();\n                this.backupForm.post('/api/backup')\n                    .then(response => {\n                        toastr.success(response.message);\n                        this.getBackups();\n                        loader.hide();\n                    })\n                    .catch(error => {\n                        loader.hide();\n                        helper.showErrorMsg(error);\n                    })\n            },\n            getBackups(page){\n                let loader = this.$loading.show();\n                if (typeof page !== 'number') {\n                    page = 1;\n                }\n                let url = helper.getFilterURL(this.filter);\n                axios.get('/api/backup?page=' + page + url)\n                    .then(response => {\n                        this.backups = response;\n                        loader.hide();\n                    })\n                    .catch(error => {\n                        loader.hide();\n                        helper.showErrorMsg(error);\n                    });\n            },\n            confirmDelete(backup){\n                return dialog => this.deleteBackup(backup);\n            },\n            deleteBackup(backup){\n                let loader = this.$loading.show();\n                axios.delete('/api/backup/'+backup.id)\n                    .then(response => {\n                        toastr.success(response.message);\n                        this.getBackups();\n                        loader.hide();\n                    }).catch(error => {\n                        loader.hide();\n                        helper.showErrorMsg(error);\n                    });\n            },\n            getDownloadLink(backup){\n                return '/backup/'+backup.id+'/download/?token='+helper.getAuthToken();\n            },\n        },\n        filters: {\n          momentDateTime(date) {\n            return helper.formatDateTime(date);\n          }\n        },\n        watch: {\n            filter: {\n                handler(val){\n                    this.getBackups();\n                },\n                deep: true\n            }\n        }\n    }\n</script>\n","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c\n  return _c(\"div\", [\n    _c(\"div\", { staticClass: \"page-titles\" }, [\n      _c(\"div\", { staticClass: \"row\" }, [\n        _c(\"div\", { staticClass: \"col-12 col-sm-6\" }, [\n          _c(\"h3\", { staticClass: \"text-themecolor\" }, [\n            _vm._v(\n              _vm._s(_vm.trans(\"utility.backup\")) + \"\\n                    \"\n            ),\n            _vm.backups.total\n              ? _c(\n                  \"span\",\n                  { staticClass: \"card-subtitle d-none d-sm-inline\" },\n                  [\n                    _vm._v(\n                      _vm._s(\n                        _vm.trans(\"general.total_result_found\", {\n                          count: _vm.backups.total,\n                          from: _vm.backups.from,\n                          to: _vm.backups.to,\n                        })\n                      )\n                    ),\n                  ]\n                )\n              : _c(\n                  \"span\",\n                  { staticClass: \"card-subtitle d-none d-sm-inline\" },\n                  [_vm._v(_vm._s(_vm.trans(\"general.no_result_found\")))]\n                ),\n          ]),\n        ]),\n        _vm._v(\" \"),\n        _c(\"div\", { staticClass: \"col-12 col-sm-6\" }, [\n          _c(\n            \"div\",\n            { staticClass: \"action-buttons pull-right\" },\n            [\n              _c(\"sort-by\", {\n                attrs: {\n                  \"order-by-options\": _vm.orderByOptions,\n                  \"sort-by\": _vm.filter.sort_by,\n                  order: _vm.filter.order,\n                },\n                on: {\n                  updateSortBy: (value) => {\n                    _vm.filter.sort_by = value\n                  },\n                  updateOrder: (value) => {\n                    _vm.filter.order = value\n                  },\n                },\n              }),\n            ],\n            1\n          ),\n        ]),\n      ]),\n    ]),\n    _vm._v(\" \"),\n    _c(\"div\", { staticClass: \"container-fluid\" }, [\n      _c(\"div\", { staticClass: \"card border-bottom\" }, [\n        _c(\n          \"div\",\n          { staticClass: \"card-body p-4\" },\n          [\n            _c(\"h4\", { staticClass: \"card-title\" }, [\n              _vm._v(_vm._s(_vm.trans(\"utility.generate_backup\"))),\n            ]),\n            _vm._v(\" \"),\n            _c(\"show-tip\", { attrs: { module: \"utility\", tip: \"tip_backup\" } }),\n            _vm._v(\" \"),\n            _c(\n              \"div\",\n              { staticClass: \"form-group\" },\n              [\n                _c(\"switches\", {\n                  staticClass: \"m-l-20\",\n                  attrs: { theme: \"bootstrap\", color: \"success\" },\n                  model: {\n                    value: _vm.backupForm.delete_previous,\n                    callback: function ($$v) {\n                      _vm.$set(_vm.backupForm, \"delete_previous\", $$v)\n                    },\n                    expression: \"backupForm.delete_previous\",\n                  },\n                }),\n                _vm._v(\n                  \" \" +\n                    _vm._s(_vm.trans(\"utility.delete_previous_backup?\")) +\n                    \"\\n                \"\n                ),\n              ],\n              1\n            ),\n            _vm._v(\" \"),\n            _c(\"div\", { staticClass: \"form-group\" }, [\n              _c(\n                \"button\",\n                {\n                  staticClass: \"btn btn-info btn-sm\",\n                  on: {\n                    click: function ($event) {\n                      $event.preventDefault()\n                      return _vm.createBackup.apply(null, arguments)\n                    },\n                  },\n                },\n                [_vm._v(_vm._s(_vm.trans(\"utility.generate_backup\")))]\n              ),\n            ]),\n          ],\n          1\n        ),\n      ]),\n      _vm._v(\" \"),\n      _c(\"div\", { staticClass: \"card\" }, [\n        _c(\n          \"div\",\n          { staticClass: \"card-body\" },\n          [\n            _vm.backups.total\n              ? _c(\"div\", { staticClass: \"table-responsive\" }, [\n                  _c(\"table\", { staticClass: \"table table-sm\" }, [\n                    _c(\"thead\", [\n                      _c(\"tr\", [\n                        _c(\"th\", [\n                          _vm._v(_vm._s(_vm.trans(\"utility.backup_name\"))),\n                        ]),\n                        _vm._v(\" \"),\n                        _c(\"th\", [\n                          _vm._v(\n                            _vm._s(_vm.trans(\"utility.backup_generated_at\"))\n                          ),\n                        ]),\n                        _vm._v(\" \"),\n                        _c(\"th\", { staticClass: \"table-option\" }, [\n                          _vm._v(_vm._s(_vm.trans(\"general.action\"))),\n                        ]),\n                      ]),\n                    ]),\n                    _vm._v(\" \"),\n                    _c(\n                      \"tbody\",\n                      _vm._l(_vm.backups.data, function (backup) {\n                        return _c(\"tr\", [\n                          _c(\"td\", {\n                            domProps: { textContent: _vm._s(backup.file) },\n                          }),\n                          _vm._v(\" \"),\n                          _c(\"td\", [\n                            _vm._v(\n                              _vm._s(\n                                _vm._f(\"momentDateTime\")(backup.created_at)\n                              )\n                            ),\n                          ]),\n                          _vm._v(\" \"),\n                          _c(\"td\", { staticClass: \"table-option\" }, [\n                            _c(\"div\", { staticClass: \"btn-group\" }, [\n                              _c(\n                                \"a\",\n                                {\n                                  directives: [\n                                    {\n                                      name: \"tooltip\",\n                                      rawName: \"v-tooltip\",\n                                      value: _vm.trans(\n                                        \"utility.download_backup\"\n                                      ),\n                                      expression:\n                                        \"trans('utility.download_backup')\",\n                                    },\n                                  ],\n                                  staticClass: \"btn btn-success btn-sm\",\n                                  attrs: { href: _vm.getDownloadLink(backup) },\n                                },\n                                [_c(\"i\", { staticClass: \"fas fa-download\" })]\n                              ),\n                              _vm._v(\" \"),\n                              _c(\n                                \"button\",\n                                {\n                                  directives: [\n                                    {\n                                      name: \"confirm\",\n                                      rawName: \"v-confirm\",\n                                      value: { ok: _vm.confirmDelete(backup) },\n                                      expression: \"{ok: confirmDelete(backup)}\",\n                                    },\n                                    {\n                                      name: \"tooltip\",\n                                      rawName: \"v-tooltip\",\n                                      value: _vm.trans(\"utility.delete_backup\"),\n                                      expression:\n                                        \"trans('utility.delete_backup')\",\n                                    },\n                                  ],\n                                  key: backup.id,\n                                  staticClass: \"btn btn-danger btn-sm\",\n                                },\n                                [_c(\"i\", { staticClass: \"fas fa-trash\" })]\n                              ),\n                            ]),\n                          ]),\n                        ])\n                      }),\n                      0\n                    ),\n                  ]),\n                ])\n              : _vm._e(),\n            _vm._v(\" \"),\n            !_vm.backups.total\n              ? _c(\"module-info\", {\n                  attrs: {\n                    module: \"utility\",\n                    title: \"backup_module_title\",\n                    description: \"backup_module_description\",\n                    icon: \"list\",\n                  },\n                })\n              : _vm._e(),\n            _vm._v(\" \"),\n            _c(\"pagination-record\", {\n              attrs: {\n                \"page-length\": _vm.filter.page_length,\n                records: _vm.backups,\n              },\n              on: {\n                \"update:pageLength\": function ($event) {\n                  return _vm.$set(_vm.filter, \"page_length\", $event)\n                },\n                \"update:page-length\": function ($event) {\n                  return _vm.$set(_vm.filter, \"page_length\", $event)\n                },\n                updateRecords: _vm.getBackups,\n              },\n              nativeOn: {\n                change: function ($event) {\n                  return _vm.getBackups.apply(null, arguments)\n                },\n              },\n            }),\n          ],\n          1\n        ),\n      ]),\n    ]),\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=f35338f2&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"C:\\\\Users\\\\admin\\\\Desktop\\\\BULK\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('f35338f2')) {\n      api.createRecord('f35338f2', component.options)\n    } else {\n      api.reload('f35338f2', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=f35338f2&\", function () {\n      api.rerender('f35338f2', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"resources/js/views/utility/backup/index.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ref--6!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=template&id=f35338f2&\""],"mappings":";;;;;;;;;;AAkEA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrKA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAOA;AAAA;AAKA;AACA;AACA;AACA;AAOA;AAAA;AAMA;AAAA;AAGA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAQA;AAAA;AACA;AAAA;AAGA;AAAA;AAEA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAUA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AASA;AAAA;AAGA;AAAA;AAGA;AAAA;AACA;AAAA;AAaA;AAAA;AASA;AAEA;AAAA;AAAA;AACA;AAUA;AAAA;AACA;AAAA;AAIA;AAEA;AACA;AACA;AAGA;AAEA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAMA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAAA;AAKA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAOA;AACA;AACA;;;;;;;;;;;;;AC9PA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAiBA;AACA;AACA;;;;;;;;;;;;ACtCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}